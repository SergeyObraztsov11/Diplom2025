import{_ as K}from"./Track-sVTIUyg5.js";import{_ as Q}from"./TrackSkeleton-D7ByGfhk.js";import{V as G,m as J,u as W,A as X,U as Y,Q as Z,r as V,n as ee,q as j,c as B,w as C,a as te,B as ae,b as se,o as n,d as s,h as c,x as ie,t as M,f as g,_ as N,F as x,R as P,S as le,k as H,i as I,p as z,j as ne}from"./index-C5SE_L3X.js";import{u as oe,a as re,_ as ue}from"./UserLayout-BSIQK8QT.js";import{_ as ce}from"./AlbumCard-B4MOmbj8.js";import{A as de}from"./AlbumCardSkeleton-Dr7mOXQj.js";import{e as fe,c as me,m as y,A as ge,S as pe,a as ve}from"./a11y-CGjrJTAs.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";function he(E,e,_,h){return E.params.createElements&&Object.keys(h).forEach(m=>{if(!_[m]&&_.auto===!0){let v=fe(E.el,`.${h[m]}`)[0];v||(v=me("div",h[m]),v.className=h[m],E.el.append(v)),_[m]=v,e[m]=v}}),_}function xe(E){let{swiper:e,extendParams:_,on:h,emit:m}=E;_({navigation:{nextEl:null,prevEl:null,hideOnClick:!1,disabledClass:"swiper-button-disabled",hiddenClass:"swiper-button-hidden",lockClass:"swiper-button-lock",navigationDisabledClass:"swiper-navigation-disabled"}}),e.navigation={nextEl:null,prevEl:null};function v(t){let a;return t&&typeof t=="string"&&e.isElement&&(a=e.el.querySelector(t)||e.hostEl.querySelector(t),a)?a:(t&&(typeof t=="string"&&(a=[...document.querySelectorAll(t)]),e.params.uniqueNavElements&&typeof t=="string"&&a&&a.length>1&&e.el.querySelectorAll(t).length===1?a=e.el.querySelector(t):a&&a.length===1&&(a=a[0])),t&&!a?t:a)}function S(t,a){const u=e.params.navigation;t=y(t),t.forEach(o=>{o&&(o.classList[a?"add":"remove"](...u.disabledClass.split(" ")),o.tagName==="BUTTON"&&(o.disabled=a),e.params.watchOverflow&&e.enabled&&o.classList[e.isLocked?"add":"remove"](u.lockClass))})}function b(){const{nextEl:t,prevEl:a}=e.navigation;if(e.params.loop){S(a,!1),S(t,!1);return}S(a,e.isBeginning&&!e.params.rewind),S(t,e.isEnd&&!e.params.rewind)}function A(t){t.preventDefault(),!(e.isBeginning&&!e.params.loop&&!e.params.rewind)&&(e.slidePrev(),m("navigationPrev"))}function $(t){t.preventDefault(),!(e.isEnd&&!e.params.loop&&!e.params.rewind)&&(e.slideNext(),m("navigationNext"))}function p(){const t=e.params.navigation;if(e.params.navigation=he(e,e.originalParams.navigation,e.params.navigation,{nextEl:"swiper-button-next",prevEl:"swiper-button-prev"}),!(t.nextEl||t.prevEl))return;let a=v(t.nextEl),u=v(t.prevEl);Object.assign(e.navigation,{nextEl:a,prevEl:u}),a=y(a),u=y(u);const o=(d,k)=>{d&&d.addEventListener("click",k==="next"?$:A),!e.enabled&&d&&d.classList.add(...t.lockClass.split(" "))};a.forEach(d=>o(d,"next")),u.forEach(d=>o(d,"prev"))}function r(){let{nextEl:t,prevEl:a}=e.navigation;t=y(t),a=y(a);const u=(o,d)=>{o.removeEventListener("click",d==="next"?$:A),o.classList.remove(...e.params.navigation.disabledClass.split(" "))};t.forEach(o=>u(o,"next")),a.forEach(o=>u(o,"prev"))}h("init",()=>{e.params.navigation.enabled===!1?L():(p(),b())}),h("toEdge fromEdge lock unlock",()=>{b()}),h("destroy",()=>{r()}),h("enable disable",()=>{let{nextEl:t,prevEl:a}=e.navigation;if(t=y(t),a=y(a),e.enabled){b();return}[...t,...a].filter(u=>!!u).forEach(u=>u.classList.add(e.params.navigation.lockClass))}),h("click",(t,a)=>{let{nextEl:u,prevEl:o}=e.navigation;u=y(u),o=y(o);const d=a.target;let k=o.includes(d)||u.includes(d);if(e.isElement&&!k){const w=a.path||a.composedPath&&a.composedPath();w&&(k=w.find(i=>u.includes(i)||o.includes(i)))}if(e.params.navigation.hideOnClick&&!k){if(e.pagination&&e.params.pagination&&e.params.pagination.clickable&&(e.pagination.el===d||e.pagination.el.contains(d)))return;let w;u.length?w=u[0].classList.contains(e.params.navigation.hiddenClass):o.length&&(w=o[0].classList.contains(e.params.navigation.hiddenClass)),m(w===!0?"navigationShow":"navigationHide"),[...u,...o].filter(i=>!!i).forEach(i=>i.classList.toggle(e.params.navigation.hiddenClass))}});const F=()=>{e.el.classList.remove(...e.params.navigation.navigationDisabledClass.split(" ")),p(),b()},L=()=>{e.el.classList.add(...e.params.navigation.navigationDisabledClass.split(" ")),r()};Object.assign(e.navigation,{enable:F,disable:L,update:b,init:p,destroy:r})}const we={class:"flex flex-col lg:flex-row gap-4"},ye={class:"flex flex-col min-w-0 flex-shrink flex-1 gap-4"},_e={class:"flex flex-row gap-4"},be={class:"w-48 h-48 flex-shrink-0 overflow-hidden rounded-full"},ke={key:0,class:"w-full h-full bg-main-light-gray dark:bg-main-gray rounded-full animate-pulse"},Ee={class:"flex flex-col justify-around w-full"},Ce={key:0,class:"h-9 md:h-12 w-64 bg-main-light-gray dark:bg-main-gray rounded animate-pulse"},Se={key:1,class:"text-4xl font-bold tracking-tight text-white truncate"},Ne={key:2,class:"bg-main-gray animate-pulse h-6 w-32 rounded-full"},Ie={key:3,class:"flex flex-row w-fit items-center gap-1 py-1 px-2 bg-main-gray text-main-white text-sm rounded-full"},Ae={class:"truncate"},Le={class:"flex items-center gap-3"},Be={class:"p-2 flex items-center justify-center hover:scale-110 transition-all"},Me={class:"flex flex-col w-full gap-2"},$e={key:2,class:"text-main-white/80 text-lg py-4 text-center"},je={class:"flex flex-col w-full gap-2"},Fe={key:0,class:"flex p-2 flex-row w-full overflow-x-hidden gap-4"},Pe={key:2,class:"text-main-white/80 text-lg py-4 text-center"},De={class:"lg:max-w-80 lg:w-fit lg:min-w-60 space-y-6"},Oe={key:0,class:"space-y-2"},Re={key:0,class:"text-base text-pretty text-main-white"},qe={key:1,class:"text-base text-main-white/80"},Te={class:"flex flex-col w-full gap-1 justify-between"},Ue={class:"flex flex-col w-full gap-1 justify-between"},Ve=["href","title"],He={class:"text-base truncate"},ze=["href","title"],et={__name:"ArtistPage",props:{artistId:{type:String,required:!1}},setup(E){const e=E,_=[xe,ge],h=te();ae(),oe();const m=G();J();const v=W(),S=X(),b=Y(),A=Z(),$=re(),p=V(!0),r=V({});ee(async()=>{p.value=!0;try{r.value=await m.getArtistById(e.artistId)}catch{b.showMessage("Ошибка при загрузке страницы исполнителя.")}finally{p.value=!1}});const F=i=>i===1?"1 слушатель":i>=1e6?`${(i/1e6).toFixed(1)}M слушателей`:i>=1e3?`${(i/1e3).toFixed(1)}K слушателей`:`${i} слушателей`,L=j(()=>r.value.tracks.map(i=>i.id)),t=j(()=>{var i,l;return(l=(i=v==null?void 0:v.currentUserData)==null?void 0:i.likedArtists)==null?void 0:l.includes(r.value.id)}),a=async()=>{t.value?await m.dislikeArtist(r.value.id):await m.likeArtist(r.value.id)},u=async()=>{try{const i=await S.getChatByUser(r.value.id);i?h.push({name:"chat-details",params:{chatId:i.id}}):A.openModal("startMessage",{targetUserId:r.value.id})}catch(i){b.showMessage("Ошибка при проверке чата"),console.log(i)}},o=()=>{A.openModal("report",{type:"user",targetId:r.value.id,targetUserId:r.value.id})},d=()=>{$.playTrackList({trackList:L.value})},k=j(()=>{var i,l;return(l=(i=r.value)==null?void 0:i.tracks)==null?void 0:l.slice(0,5)}),w=j(()=>{var i,l;return(l=(i=r.value)==null?void 0:i.albums)==null?void 0:l.slice(0,5)});return(i,l)=>{const D=se("RouterLink");return n(),B(ue,null,{default:C(()=>{var O,R,q,T,U;return[s("div",we,[s("section",ye,[s("div",_e,[s("div",be,[p.value?(n(),c("div",ke)):(n(),B(ie,{key:1,url:(O=r.value)==null?void 0:O.imageURL,class:"w-full h-full shadow-xl",icon:"playlist"},null,8,["url"]))]),s("div",Ee,[l[4]||(l[4]=s("p",{class:"text-sm font-medium text-white/50"}," Исполнитель ",-1)),p.value?(n(),c("div",Ce)):(n(),c("h1",Se,M(r.value.displayName),1)),p.value?(n(),c("div",Ne)):(n(),c("div",Ie,[g(N,{iconName:"PersonIcon",class:"fill-white w-4 h-4"}),s("span",Ae,M(F(r.value.listenersCount)),1)])),s("div",Le,[p.value?(n(),c(x,{key:0},[l[0]||(l[0]=s("div",{class:"bg-main-gray animate-pulse rounded-full w-10 h-10"},null,-1)),l[1]||(l[1]=s("div",{class:"bg-main-gray animate-pulse rounded-full w-8 h-8"},null,-1)),l[2]||(l[2]=s("div",{class:"bg-main-gray animate-pulse rounded-full w-8 h-8"},null,-1)),l[3]||(l[3]=s("div",{class:"bg-main-gray animate-pulse rounded-full w-8 h-8"},null,-1))],64)):(n(),c(x,{key:1},[s("button",{class:"p-2 flex items-center justify-center bg-main-color hover:bg-blue-600 rounded-full transition-all",title:"Слушать популярное",onClick:d},[g(N,{iconName:"PlayArrowIcon",class:"fill-white w-6 h-6"})]),s("button",{onClick:a,title:"Нравится",class:"p-2 flex items-center justify-center hover:scale-110 transition-all"},[g(N,{iconName:t.value?"FavoriteFillIcon":"FavoriteIcon",class:"fill-white w-6 h-6"},null,8,["iconName"])]),s("button",{onClick:u,title:"Написать сообщение",class:"p-2 flex items-center justify-center hover:scale-110 transition-all"},[g(N,{iconName:"MessageIcon",class:"fill-white w-5 h-5"})]),g(le,null,{trigger:C(()=>[s("button",Be,[g(N,{iconName:"MoreHorizIcon",class:"fill-white w-6 h-6"})])]),content:C(()=>[g(P,{onClick:d,iconName:"PlayArrowIcon",text:"Слушать"}),g(P,{onClick:a,iconName:t.value?"FavoriteFillIcon":"FavoriteIcon",text:t.value?"Нравится":"Не нравится"},null,8,["iconName","text"]),g(P,{onClick:o,iconName:"ReportIcon",isRed:!0,text:"Пожаловаться на профиль"})]),_:1})],64))])])]),s("div",Me,[g(D,{to:{name:"artist-tracks",params:{artistId:r.value.id}},class:"text-2xl font-semibold hover:text-main-white/80 transition-colors"},{default:C(()=>l[5]||(l[5]=[H(" Популярное ")])),_:1},8,["to"]),p.value?(n(),c(x,{key:0},I(5,f=>g(Q,{key:f,isShowImage:!0})),64)):((R=k.value)==null?void 0:R.length)>0?(n(!0),c(x,{key:1},I(k.value,f=>(n(),B(K,{key:f.id,data:f,isShowImage:!0,list:L.value},null,8,["data","list"]))),128)):(n(),c("p",$e," Треки не найдены. "))]),s("div",je,[g(D,{to:{name:"artist-albums",params:{artistId:r.value.id}},class:"text-2xl font-semibold hover:text-main-white/80 transition-colors"},{default:C(()=>l[6]||(l[6]=[H(" Альбомы ")])),_:1},8,["to"]),p.value?(n(),c("div",Fe,[(n(),c(x,null,I(3,f=>g(de,{key:f})),64))])):((q=w.value)==null?void 0:q.length)>0?(n(),B(z(pe),{key:1,"space-between":32,modules:_,navigation:"","slides-per-view":"auto",class:"w-full"},{default:C(()=>[(n(!0),c(x,null,I(w.value,f=>(n(),B(z(ve),{key:f.id,class:"!w-fit"},{default:C(()=>[g(ce,{album:f},null,8,["album"])]),_:2},1024))),128))]),_:1})):(n(),c("p",Pe," Альбомы не найдены. "))])]),s("section",De,[s("div",null,[l[8]||(l[8]=s("h2",{class:"text-xl font-bold mb-3"},"Об исполнителе",-1)),p.value?(n(),c("div",Oe,l[7]||(l[7]=[s("div",{class:"h-5 w-full bg-main-light-gray dark:bg-main-gray rounded animate-pulse"},null,-1),s("div",{class:"h-5 w-3/4 bg-main-light-gray dark:bg-main-gray rounded animate-pulse"},null,-1),s("div",{class:"h-5 w-5/6 bg-main-light-gray dark:bg-main-gray rounded animate-pulse"},null,-1)]))):(n(),c(x,{key:1},[r.value.description?(n(),c("p",Re,M(r.value.description),1)):(n(),c("p",qe," Описание отсутствует. "))],64))]),s("div",null,[p.value?(n(),c(x,{key:0},I(4,f=>s("div",Te,l[9]||(l[9]=[s("div",{class:"h-5 w-1/2 bg-main-gray rounded animate-pulse"},null,-1),s("div",{class:"h-5 w-full bg-main-gray rounded animate-pulse"},null,-1)]))),64)):((U=(T=r.value)==null?void 0:T.socialLinks)==null?void 0:U.length)>0?(n(),c(x,{key:1},[l[10]||(l[10]=s("h2",{class:"text-xl font-bold mb-3"},"Ссылки",-1)),(n(!0),c(x,null,I(r.value.socialLinks,f=>(n(),c("div",Ue,[s("a",{href:f.url,target:"_blank",rel:"noopener noreferrer",title:f.name,class:"hover:text-white transition h-5 flex flex-row w-fit items-center gap-1"},[s("span",He,M(f.name),1),g(N,{iconName:"ArrowOutIcon",class:"fill-current w-5 h-5"})],8,Ve),s("a",{href:f.url,target:"_blank",rel:"noopener noreferrer",title:f.name,class:"h-5 w-full text-main-white/50 truncate hover:text-main-white hover:underline transition"},M(f.url),9,ze)]))),256))],64)):ne("",!0)])])])]}),_:1})}}};export{et as default};
