import{q as n,o as l,h as p,f as c,x as D,g as y,a1 as w,d as f,c as v,y as b,_ as I,j as x,t as g,a as j,u as L,U as M,r as F,s as R,w as N,R as h,S as U}from"./index-BXMH6y3x.js";import{a as T,u as z,b as $}from"./UserLayout-ol4tnCCV.js";const E={class:"flex h-full w-full relative rounded-md overflow-hidden z-auto"},V={class:"absolute inset-0 h-full w-full flex justify-center items-center bg-black/30 dark:bg-black/50 transition-all duration-200"},O={__name:"TrackImageButton",props:{imageUrl:{type:String,required:!1},trackId:{type:String,required:!0},isHover:{type:Boolean,default:!1}},setup(u){const e=u,r=T(),o=n(()=>{var s;return e.trackId===((s=r==null?void 0:r.currentTrackData)==null?void 0:s.id)}),a=n(()=>o.value||e.isHover),d=n(()=>o.value?e.isHover?r.isPaused?"PlayArrowIcon":"PauseIcon":"CircleIcon":e.isHover?"PlayArrowIcon":null),k=n(()=>o.value&&!r.isPaused&&!e.isHover);return(s,m)=>(l(),p("div",E,[c(D,{url:u.imageUrl},null,8,["url"]),y(f("div",V,[d.value?(l(),v(I,{key:0,iconName:d.value,class:b(["fill-main-black dark:fill-main-white",{"animate-pulse duration-1000":k.value}])},null,8,["iconName","class"])):x("",!0)],512),[[w,a.value]])]))}},G={class:"flex h-full aspect-square items-center justify-center relative"},J={class:"flex-1 items-center justify-center"},K={key:0},Q={class:"absolute inset-0 flex items-center justify-center"},W={__name:"TrackNumberButton",props:{index:{type:Number,required:!0},trackId:{type:String,required:!0},isHover:{type:Boolean,default:!1}},setup(u){const e=u,r=T(),o=n(()=>{var s;return e.trackId===((s=r==null?void 0:r.currentTrackData)==null?void 0:s.id)}),a=n(()=>o.value||e.isHover),d=n(()=>o.value?e.isHover?r.isPaused?"PlayArrowIcon":"PauseIcon":"CircleIcon":e.isHover?"PlayArrowIcon":null),k=n(()=>o.value&&!r.isPaused&&!e.isHover);return(s,m)=>(l(),p("div",G,[f("div",J,[a.value?x("",!0):(l(),p("span",K,g(u.index),1))]),y(f("div",Q,[d.value?(l(),v(I,{key:0,iconName:d.value,class:b(["fill-main-black dark:fill-main-white",{"animate-pulse duration-1000":k.value}])},null,8,["iconName","class"])):x("",!0)],512),[[w,a.value]])]))}},X={class:"flex flex-row items-center min-w-0 flex-1 gap-4"},Y={class:"truncate font-semibold hover:text-black dark:hover:text-white"},te={__name:"Track",props:{isShowImage:{type:Boolean,default:!0,required:!1},index:{type:Number,default:null,required:!1},data:{type:Object,required:!0},list:{type:Array,required:!1,default:()=>[]}},setup(u){const e=u,r=j(),o=z(),a=T(),d=L(),k=M(),s=F(!1),m=n(()=>{var t,i;return(i=(t=d.currentUserData)==null?void 0:t.likedTracks)==null?void 0:i.includes(e.data.id)}),P=n(()=>{var t;return e.data.id===((t=a==null?void 0:a.currentTrackData)==null?void 0:t.id)}),C=()=>{m.value?o.dislikeTrack(e.data.id):o.likeTrack(e.data.id)},S=()=>{var t,i;e.data.id===((t=a.currentTrackData)==null?void 0:t.id)&&a.isPaused?a.resumeCurrentTrack():e.data.id===((i=a.currentTrackData)==null?void 0:i.id)&&!a.isPaused?a.pauseCurrentTrack():a.playTrackList({id:e.data.id,trackList:e.list})},H=()=>{r.push({name:"album",params:{albumId:e.data.album.id}})},q=()=>{r.push({name:"artist",params:{artistId:e.data.author.id}})},A=async()=>{try{const t=`${window.location.origin}/album/${e.data.album.id}?trackId=${e.data.id}`;await navigator.clipboard.writeText(t),k.showMessage(`Ссылка на трек ${e.data.title} (${e.data.album.title}) успешно скопирована.`)}catch{k.showMessage("Произошла ошибка при копированнии ссылки.")}},B=n(()=>{const t=e.data.duration;if(!t)return"0:00";const _=Math.floor(t/3600)>0?"H:mm:ss":"m:ss";return R.utc(t*1e3).format(_)});return(t,i)=>(l(),p("div",{class:b(["flex flex-row items-center justify-start rounded-lg list-none h-16 p-2 gap-4 hover:bg-main-white dark:hover:bg-main-gray transition-all w-full",{"bg-main-white dark:bg-main-gray":P.value}]),onMouseover:i[0]||(i[0]=_=>s.value=!0),onMouseleave:i[1]||(i[1]=_=>s.value=!1)},[f("button",{onClick:S,class:"flex h-full flex-shrink-0 aspect-square items-center justify-center"},[e.isShowImage?(l(),v(O,{key:0,"image-url":e.data.imageURL,"track-id":e.data.id,"is-hover":s.value},null,8,["image-url","track-id","is-hover"])):(l(),v(W,{key:1,index:e.index,"track-id":e.data.id,"is-hover":s.value},null,8,["index","track-id","is-hover"]))]),f("div",X,[f("span",Y,g(e.data.title),1),e.data.isExplicit?(l(),v(I,{key:0,iconName:"ExplicitIcon",class:"flex-shrink-0 fill-main-light-gray"})):x("",!0)]),y(f("span",{class:"text-main-white/50 p-2 transition"},g(B.value),513),[[w,s.value]]),c($,{onClick:C,class:"flex-shrink-0",type:"text",iconName:m.value?"FavoriteFillIcon":"FavoriteIcon",title:m.value?"Нравится":"Не нравится"},null,8,["iconName","title"]),c(U,{placement:"bottom-left"},{trigger:N(()=>[c($,{class:"ml-auto",type:"text",iconName:"MoreHorizIcon"})]),content:N(()=>[c(h,{onClick:C,iconName:m.value?"FavoriteFillIcon":"FavoriteIcon",text:m.value?"Нравится":"Не нравится"},null,8,["iconName","text"]),c(h,{onClick:H,iconName:"ArrowTopRightIcon",text:"Перейти к альбому"}),c(h,{onClick:q,iconName:"ArrowTopRightIcon",text:"Перейти к исполнителю"}),c(h,{onClick:A,iconName:"ShareIcon",text:"Копировать ссылку"})]),_:1})],34))}};export{te as _};
