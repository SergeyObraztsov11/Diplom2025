import"./momentConfig-CqCZObZq.js";import{q as p,s as y,o as f,h as x,d as l,y as h,t as v,r as b,g as _,v as C,A as M,u as k,n as U,z as I,F as $,i as S,f as D,C as q,c as B}from"./index-C3zZXPKa.js";const T={class:"text-white font-semibold truncate"},j={class:"text-xs text-main-white/50 truncate"},V={__name:"ChatMessage",props:{sender:{type:Object,required:!0},content:{type:Object,required:!0},timestamp:{type:Object,required:!0},isCurrentUserMessage:{type:Boolean,default:!1,required:!1}},setup(a){const u=a,d=p(()=>{const e=u.timestamp.toDate(),s=y(),r=y(e),i=s.diff(r,"minutes"),o=s.diff(r,"hours"),n=s.diff(r,"days"),c=s.diff(r,"weeks"),t=s.diff(r,"years");return i<1?"только что":i<60?`${i}м`:o<24?`${o}ч`:n<7?`${n}д`:c<52?`${c}н`:`${t}г`});return(e,s)=>(f(),x("div",{class:h(["flex flex-col w-full",a.isCurrentUserMessage?"items-end":"items-start"])},[l("div",{class:h(["flex flex-col w-fit max-w-full sm:max-w-[70%] p-3 rounded-2xl break-words",[a.isCurrentUserMessage?"bg-main-white/10 ml-6 items-end":"bg-main-gray mr-6 items-start"]])},[l("div",{class:h(["flex flex-row w-full gap-2 mb-1 items-center",a.isCurrentUserMessage?"justify-end":"justify-start"])},[l("span",T,v(a.sender.displayName),1),l("span",j,v(d.value),1)],2),l("p",{class:h(["flex w-fit text-main-white text-pretty",a.isCurrentUserMessage?"text-right":"text-left"])},v(u.content.value),3)],2)],2))}},z={class:"flex flex-row w-full items-end gap-2"},K=["disabled"],N={__name:"CreateMessage",emits:["send"],setup(a,{emit:u}){const d=u,e=b(""),s=p(()=>e.value.length>0),r=o=>{o.key==="Enter"&&!o.shiftKey&&(o.preventDefault(),i())},i=()=>{e.value.trim()&&(d("send",e.value),e.value="")};return(o,n)=>(f(),x("div",z,[_(l("textarea",{"onUpdate:modelValue":n[0]||(n[0]=c=>e.value=c),class:"flex focus:border-main-white/50 w-full p-2 text-base bg-transparent border-2 border-main-gray rounded-xl resize-none placeholder:text-main-white/50 transition-colors",placeholder:"Сообщение",onKeydown:r,rows:"1"},null,544),[[C,e.value,void 0,{trim:!0}]]),l("button",{onClick:i,class:"px-4 py-2 bg-main-gray rounded-full transition hover:bg-main-white/10 disabled:opacity-50",disabled:!s.value,title:"Отправить"}," Отправить ",8,K)]))}},O={class:"flex flex-col w-full h-full gap-2"},F={__name:"ChatMessages",props:{chatId:{type:String,required:!0}},setup(a){const u=a,d=M(),e=k(),s=p(()=>e.currentUserId),r=p(()=>d.chats.find(t=>t.id===u.chatId)),i=t=>t===s.value,o=t=>{d.sendMessage(u.chatId,t)},n=b(null),c=()=>{q(()=>{n.value&&(n.value.scrollTop=n.value.scrollHeight)})};return U(()=>{c()}),I(()=>{var t,g;return(g=(t=r.value)==null?void 0:t.messages)==null?void 0:g.length},()=>{c()}),(t,g)=>{var w;return f(),x("div",O,[l("div",{ref_key:"messagesContainer",ref:n,class:"flex flex-col w-full h-full overflow-y-auto gap-2"},[(f(!0),x($,null,S((w=r.value)==null?void 0:w.messages,m=>(f(),B(V,{isCurrentUserMessage:i(m.sender.id),sender:m.sender,content:m.content,timestamp:m.timestamp},null,8,["isCurrentUserMessage","sender","content","timestamp"]))),256))],512),D(N,{onSend:o})])}}};export{F as default};
